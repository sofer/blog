<!DOCTYPE html>
<html>
<head>
<title>Sanitizing input in Rails</title>
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
<link href="/stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
<!--[if lt IE 8]>
    <link href="/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
<![endif]-->
<link href="/stylesheets/application.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body>

  <div class='container'>
    <div class="strapline">
        <div class="breadcrumb"><a href="http://sofer.com">sofer.com</a> &raquo; <a href="/">blog</a> &raquo;  <a href="/tech.html">tech</a></div>
        <div class="date"> 7 July 2009</div>
    </div>    
    <div class='content'>
      <h1>Sanitizing input in Rails</h1>
      <p>Rails offers the <code>html_escape</code> method (usually shortened to <code>h</code>), which prevents simple attempts at code injection. However, when users are entering content onto a site, there is a very good case for sanitizing the input. After all, if a rogue user is injecting unwanted code into my <span class="caps">HTML</span> forms, why would I want to store it in my database? It makes sense to neutralize it before it gets stored.</p>
<p>A couple of years ago Jay Laney wrote a plugin called sanitize_params to do precisely that. It uses Rick Olsen&#8217;s white_list plugin to sanitize incoming params before they hit the controller.</p>
<p>Since then, Rick&#8217;s plugin has been incorporated into the Rails trunk as the Sanitizer module (the <code>HTML::Sanitizer::WhiteListSanitizer</code> class does more-or-less the same job as the original <code>white_list</code> method in his plugin).</p>
<p>As Rick pointed out some time ago, &#8220;the common technique was to mix the helpers directly in to your model and call them directly.  However, I recently just refactored a lot of that code into the html tokenizer library.  You can now access the classes directly as <span class="caps">HTML</span>::Sanitizer, <span class="caps">HTML</span>::LinkSanitizer, and <span class="caps">HTML</span>::WhiteListSanitizer&#8221;.</p>
<p>So, I downloaded the original plugin, amended the code to use <span class="caps">HTML</span>::WhiteListSanitizer, installed it into my application and then uploaded it to <a href="http://github.com/sofer/sanitize_params/">github</a>.</p>
<p>It seems to work very nicely now.</p>
    </div>
  </div>

</body>
</html>
